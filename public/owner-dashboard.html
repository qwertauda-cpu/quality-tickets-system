<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' http://136.111.97.150:3001; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://136.111.97.150:3001; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: blob: http://136.111.97.150:3001; connect-src 'self' http://136.111.97.150:3001;">
    <title>ููุญุฉ ุงููุงูู - ูุธุงู ุฅุฏุงุฑุฉ ุงูุชูุชุงุช</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">โฐ</button>
    <div class="mobile-menu-overlay" onclick="toggleMobileMenu()"></div>
    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>๐ ููุญุฉ ุงููุงูู</h2>
                <p id="userName"></p>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="active" data-page="dashboard"><i>๐</i> ููุญุฉ ุงูุชุญูู</a></li>
                <li><a href="#" data-page="companies"><i>๐ข</i> ุฅุฏุงุฑุฉ ุงูุดุฑูุงุช</a></li>
                <li><a href="#" data-page="employees"><i>๐ฅ</i> ุฅุฏุงุฑุฉ ุงูููุธููู</a></li>
                <li><a href="#" data-page="invoices"><i>๐ฐ</i> ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ</a></li>
                <li><a href="#" data-page="purchase-requests"><i>๐ฅ</i> ุงุณุชูุงู ุงูุทูุจุงุช</a></li>
                <li><a href="#" data-page="database"><i>๐๏ธ</i> ูุงุนุฏุฉ ุงูุจูุงูุงุช</a></li>
                <li><a href="#" onclick="logout(); return false;"><i>๐ช</i> ุชุณุฌูู ุงูุฎุฑูุฌ</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="header">
                <h1 id="pageTitle">ููุญุฉ ุงูุชุญูู</h1>
                <div class="user-info">
                    <span id="currentUser"></span>
                    <a href="#" class="btn-logout" onclick="logout(); return false;">ุชุณุฌูู ุงูุฎุฑูุฌ</a>
                </div>
            </div>

            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page-content">
                <div class="stats-grid" id="statsGrid">
                    <div class="stat-card">
                        <h3>ุนุฏุฏ ุงูุดุฑูุงุช ุงููุดุทุฉ</h3>
                        <div class="value" id="totalCompanies">0</div>
                    </div>
                    <div class="stat-card secondary">
                        <h3>ุฅุฌูุงูู ุงูููุธููู</h3>
                        <div class="value" id="totalEmployees">0</div>
                    </div>
                    <div class="stat-card warning">
                        <h3>ุงูููุงุชูุฑ ุงููุนููุฉ</h3>
                        <div class="value" id="pendingInvoices">0</div>
                    </div>
                    <div class="stat-card success">
                        <h3>ุทูุจุงุช ุงูุดุฑุงุก ุงููุนููุฉ</h3>
                        <div class="value" id="pendingRequests">0</div>
                    </div>
                    <div class="stat-card info">
                        <h3>ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช</h3>
                        <div class="value" id="totalRevenue">0</div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <button class="btn btn-primary btn-large" onclick="openAddCompanyModal()">
                        <span style="font-size: 20px; margin-left: 8px;">โ</span>
                        <span>ุฅุถุงูุฉ ุดุฑูุฉ ุฌุฏูุฏุฉ</span>
                    </button>
                    <button class="btn btn-success btn-large" onclick="openCreateInvoiceModal()">
                        <span style="font-size: 20px; margin-left: 8px;">๐ฐ</span>
                        <span>ุฅูุดุงุก ูุงุชูุฑุฉ</span>
                    </button>
                </div>
            </div>

            <!-- Companies Management Page -->
            <div id="companies-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุงุฑุฉ ุงูุดุฑูุงุช</h2>
                        <button class="btn btn-primary" onclick="openAddCompanyModal()">โ ุฅุถุงูุฉ ุดุฑูุฉ ุฌุฏูุฏุฉ</button>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="companiesTable">
                                <thead>
                                    <tr>
                                        <th>ุงุณู ุงูุดุฑูุฉ</th>
                                        <th>ุงููุฌุงู (Domain)</th>
                                        <th>ุงุณู ุงููุฏูุฑ</th>
                                        <th>ุนุฏุฏ ุงูููุธููู</th>
                                        <th>ุงูุณุนุฑ/ููุธู</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="companiesTableBody">
                                    <tr>
                                        <td colspan="7" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Employees Management Page -->
            <div id="employees-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุงุฑุฉ ุงูููุธููู</h2>
                        <div style="display: flex; gap: 10px;">
                            <select id="filterCompanyEmployees" class="form-control" style="width: 200px;" onchange="loadEmployees()">
                                <option value="">ุฌููุน ุงูุดุฑูุงุช</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="employeesTable">
                                <thead>
                                    <tr>
                                        <th>ุงุณู ุงููุณุชุฎุฏู</th>
                                        <th>ุงูุงุณู ุงููุงูู</th>
                                        <th>ุงูุฏูุฑ</th>
                                        <th>ุงูุดุฑูุฉ</th>
                                        <th>ุงููุฑูู</th>
                                        <th>ุงูุญุงูุฉ</th>
                                    </tr>
                                </thead>
                                <tbody id="employeesTableBody">
                                    <tr>
                                        <td colspan="6" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Invoices Management Page -->
            <div id="invoices-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ</h2>
                        <button class="btn btn-primary" onclick="openCreateInvoiceModal()">โ ุฅูุดุงุก ูุงุชูุฑุฉ</button>
                    </div>
                    <div class="card-body">
                        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                            <select id="filterCompanyInvoices" class="form-control" style="width: 200px;" onchange="loadInvoices()">
                                <option value="">ุฌููุน ุงูุดุฑูุงุช</option>
                            </select>
                            <select id="filterStatusInvoices" class="form-control" style="width: 200px;" onchange="loadInvoices()">
                                <option value="">ุฌููุน ุงูุญุงูุงุช</option>
                                <option value="draft">ูุณูุฏุฉ</option>
                                <option value="sent">ูุฑุณูุฉ</option>
                                <option value="paid">ูุฏููุนุฉ</option>
                                <option value="overdue">ูุชุฃุฎุฑุฉ</option>
                                <option value="cancelled">ููุบุงุฉ</option>
                            </select>
                        </div>
                        <div class="table-container">
                            <table id="invoicesTable">
                                <thead>
                                    <tr>
                                        <th>ุฑูู ุงููุงุชูุฑุฉ</th>
                                        <th>ุงูุดุฑูุฉ</th>
                                        <th>ุงููุชุฑุฉ</th>
                                        <th>ุนุฏุฏ ุงูููุธููู</th>
                                        <th>ุงููุจูุบ ุงูุฅุฌูุงูู</th>
                                        <th>ุชุงุฑูุฎ ุงูุงุณุชุญูุงู</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="invoicesTableBody">
                                    <tr>
                                        <td colspan="8" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Purchase Requests Page -->
            <div id="purchase-requests-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุงุณุชูุงู ุงูุทูุจุงุช</h2>
                        <select id="filterStatusRequests" class="form-control" style="width: 200px;" onchange="loadPurchaseRequests()">
                            <option value="">ุฌููุน ุงูุญุงูุงุช</option>
                            <option value="pending">ูุนููุฉ</option>
                            <option value="contacted">ุชู ุงูุชูุงุตู</option>
                            <option value="approved">ููุงูู ุนูููุง</option>
                            <option value="rejected">ูุฑููุถุฉ</option>
                            <option value="converted">ูุญููุฉ</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="purchaseRequestsTable">
                                <thead>
                                    <tr>
                                        <th>ุงุณู ุงูุดุฑูุฉ</th>
                                        <th>ุงุณู ุงููุณุคูู</th>
                                        <th>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                                        <th>ุงููุงุชู</th>
                                        <th>ุนุฏุฏ ุงูููุธููู ุงููุชููุน</th>
                                        <th>ุชุงุฑูุฎ ุงูุทูุจ</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="purchaseRequestsTableBody">
                                    <tr>
                                        <td colspan="8" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Database Management Page -->
            <div id="database-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช</h2>
                        <button class="btn btn-primary" onclick="loadDatabaseTables()">๐ ุชุญุฏูุซ ุงููุงุฆูุฉ</button>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="databaseTablesTable">
                                <thead>
                                    <tr>
                                        <th>ุงุณู ุงูุฌุฏูู</th>
                                        <th>ุงููุตู</th>
                                        <th>ุนุฏุฏ ุงูุณุฌูุงุช</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="databaseTablesTableBody">
                                    <tr>
                                        <td colspan="4" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add Company Modal -->
    <div id="addCompanyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุฅุถุงูุฉ ุดุฑูุฉ ุฌุฏูุฏุฉ</h2>
                <span class="close" onclick="closeAddCompanyModal()">&times;</span>
            </div>
            <form id="addCompanyForm">
                <div class="form-group">
                    <label>ุงุณู ุงูุดุฑูุฉ *</label>
                    <input type="text" id="company_name" required>
                </div>
                <div class="form-group">
                    <label>ุงููุฌุงู (Domain) * <small>ูุซู: tec</small></label>
                    <input type="text" id="company_domain" required placeholder="tec">
                </div>
                <div class="form-group">
                    <label>ุงุณู ุงููุณุคูู *</label>
                    <input type="text" id="company_contact_name" required>
                </div>
                <div class="form-group">
                    <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู *</label>
                    <input type="email" id="company_contact_email" required>
                </div>
                <div class="form-group">
                    <label>ุฑูู ุงููุงุชู</label>
                    <input type="text" id="company_contact_phone">
                </div>
                <div class="form-group">
                    <label>ุงูุนููุงู</label>
                    <textarea id="company_address" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>ุงูุญุฏ ุงูุฃูุตู ููููุธููู</label>
                    <input type="number" id="company_max_employees" min="0" value="0">
                </div>
                <div class="form-group">
                    <label>ุงูุณุนุฑ ููู ููุธู *</label>
                    <input type="number" id="company_price_per_employee" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label>ูููุฉ ูุฑูุฑ ุงููุฏูุฑ (admin@domain) *</label>
                    <input type="password" id="company_admin_password" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddCompanyModal()">ุฅูุบุงุก</button>
                    <button type="submit" class="btn btn-primary">ุฅูุดุงุก</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Invoice Modal -->
    <div id="createInvoiceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุฅูุดุงุก ูุงุชูุฑุฉ</h2>
                <span class="close" onclick="closeCreateInvoiceModal()">&times;</span>
            </div>
            <form id="createInvoiceForm">
                <div class="form-group">
                    <label>ุงูุดุฑูุฉ *</label>
                    <select id="invoice_company_id" required>
                        <option value="">ุงุฎุชุฑ ุงูุดุฑูุฉ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ุจุฏุงูุฉ ุงููุชุฑุฉ *</label>
                    <input type="date" id="invoice_period_start" required>
                </div>
                <div class="form-group">
                    <label>ููุงูุฉ ุงููุชุฑุฉ *</label>
                    <input type="date" id="invoice_period_end" required>
                </div>
                <div class="form-group">
                    <label>ุนุฏุฏ ุงูููุธููู *</label>
                    <input type="number" id="invoice_employee_count" min="1" required>
                </div>
                <div class="form-group">
                    <label>ุงูุณุนุฑ ููู ููุธู *</label>
                    <input type="number" id="invoice_price_per_employee" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label>ุงูุถุฑูุจุฉ</label>
                    <input type="number" id="invoice_tax" step="0.01" min="0" value="0">
                </div>
                <div class="form-group">
                    <label>ุชุงุฑูุฎ ุงูุงุณุชุญูุงู</label>
                    <input type="date" id="invoice_due_date">
                </div>
                <div class="form-group">
                    <label>ููุงุญุธุงุช</label>
                    <textarea id="invoice_notes" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeCreateInvoiceModal()">ุฅูุบุงุก</button>
                    <button type="submit" class="btn btn-primary">ุฅูุดุงุก</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Purchase Request Details Modal -->
    <div id="purchaseRequestModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุชูุงุตูู ุทูุจ ุงูุดุฑุงุก</h2>
                <span class="close" onclick="closePurchaseRequestModal()">&times;</span>
            </div>
            <div id="purchaseRequestDetails"></div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alertModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 id="alertTitle">ุชูุจูู</h2>
                <span class="close" onclick="closeAlertModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p id="alertMessage"></p>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-primary" onclick="closeAlertModal()">ููุงูู</button>
            </div>
        </div>
    </div>

    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/owner-dashboard.js"></script>
</body>
</html>

