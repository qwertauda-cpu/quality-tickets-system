<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>ููุญุฉ ุงูุฅุฏุงุฑุฉ - ูุธุงู ุฅุฏุงุฑุฉ ุงูุชุฐุงูุฑ</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" aria-label="ุงููุงุฆูุฉ">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>
    <div class="mobile-menu-overlay" onclick="toggleMobileMenu()"></div>
    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>ููุญุฉ ุงูุฅุฏุงุฑุฉ</h2>
                <p id="userName"></p>
            </div>
            <ul class="sidebar-menu" id="sidebarMenu"></ul>
        </aside>

        <main class="main-content">
            <div class="header">
                <h1 id="pageTitle">ููุญุฉ ุงูุชุญูู</h1>
                <div class="user-info">
                    <div class="notifications-bell" id="notificationsBell" onclick="showNotifications()" style="position: relative; cursor: pointer; margin-left: 15px; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: var(--bg-tertiary); border-radius: 50%; border: 2px solid var(--border-color); transition: all var(--transition-base);">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--text-secondary);">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                        <span class="notification-badge" id="notificationBadge" style="display: none; position: absolute; top: -5px; right: -5px; background: var(--danger-color); color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 11px; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid var(--bg-primary); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);">0</span>
                    </div>
                    <span id="currentUser"></span>
                    <a href="#" class="btn-logout" onclick="logout(); return false;">ุชุณุฌูู ุงูุฎุฑูุฌ</a>
                </div>
            </div>
            
            <!-- Notifications Overlay -->
            <div id="notificationsOverlay" class="notifications-overlay" onclick="closeNotifications()"></div>
            
            <!-- Notifications Dropdown -->
            <div id="notificationsDropdown" class="notifications-dropdown">
                <div class="notifications-header">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <h3 style="margin: 0;">ุงูุฅุดุนุงุฑุงุช</h3>
                        <span id="notificationsCount" class="notification-count-badge">0</span>
                    </div>
                    <div style="display: flex; gap: 5px;">
                        <button onclick="markAllNotificationsRead()" class="btn btn-sm btn-secondary">ุชุนููู ุงููู ูููุฑูุก</button>
                        <button onclick="closeNotifications()" class="btn-close-notifications" title="ุฅุบูุงู">โ</button>
                    </div>
                </div>
                <div id="notificationsList" class="notifications-list"></div>
                <div class="notifications-footer">
                    <button onclick="closeNotifications()" class="btn btn-sm btn-primary" style="width: 100%;">ุฅุบูุงู</button>
                </div>
            </div>

            <div id="dashboard-page" class="page-content">
                <div class="stats-grid" id="statsGrid">
                    <div class="stat-card">
                        <h3>ุฅุฌูุงูู ุงูุชุฐุงูุฑ ุงูููู</h3>
                        <div class="value" id="totalTickets">0</div>
                    </div>
                    <div class="stat-card secondary">
                        <h3>ุงูุชุฐุงูุฑ ุงูููุชููุฉ</h3>
                        <div class="value" id="completedTickets">0</div>
                    </div>
                    <div class="stat-card warning">
                        <h3>ุงูุชุฐุงูุฑ ุงููุนููุฉ</h3>
                        <div class="value" id="pendingTickets">0</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2>ุชุฑุชูุจ ุงููุฑู</h2>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="rankingsTable">
                                <thead>
                                    <tr>
                                        <th>ุงูุชุฑุชูุจ</th>
                                        <th>ุงุณู ุงููุฑูู</th>
                                        <th>ุงูููุงุท ุงูุฅุฌูุงููุฉ</th>
                                        <th>ุนุฏุฏ ุงูุชุฐุงูุฑ</th>
                                        <th>ุงูููุงุท ุงูุตุงููุฉ</th>
                                    </tr>
                                </thead>
                                <tbody id="rankingsTableBody">
                                    <tr>
                                        <td colspan="5" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="teams-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุงููุฑู</h2>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="teamsTable">
                                <thead>
                                    <tr>
                                        <th>ุงุณู ุงููุฑูู</th>
                                        <th>ุงููุฑุฏูุฉ</th>
                                        <th>ุนุฏุฏ ุงูุฃุนุถุงุก</th>
                                        <th>ุญุฏ ุงูุฑุจุท</th>
                                        <th>ุญุฏ ุงูุตูุงูุฉ</th>
                                        <th>ุงูุญุงูุฉ</th>
                                    </tr>
                                </thead>
                                <tbody id="teamsTableBody">
                                    <tr>
                                        <td colspan="6" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tickets-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุงูุชุฐุงูุฑ</h2>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <button class="btn btn-primary" onclick="openCreateTicketModal()" style="margin-right: 10px;">โ ุฅูุดุงุก ุชุฐูุฑุฉ</button>
                            <label>
                                <input type="checkbox" id="autoRefreshTickets" checked> ุชุญุฏูุซ ุชููุงุฆู (30 ุซุงููุฉ)
                            </label>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="filters-bar" style="margin-bottom: 20px; display: flex; flex-wrap: wrap; gap: 10px; align-items: center;">
                            <div class="form-group" style="margin: 0;">
                                <label>ุงูุจุญุซ:</label>
                                <input type="text" id="ticketsSearch" placeholder="ุงุจุญุซ ูู ุฑูู ุงูุชุฐูุฑุฉุ ุงูููุนุ ุงููุฑูู..." onkeyup="filterTickets()" style="width: 250px;">
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <label>ุงูุชุงุฑูุฎ:</label>
                                <input type="date" id="ticketsDateFilter" onchange="filterTickets()">
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <label>ุงููุฑูู:</label>
                                <select id="ticketsTeamFilter" onchange="filterTickets()">
                                    <option value="">ุฌููุน ุงููุฑู</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <label>ุงูููุน:</label>
                                <select id="ticketsTypeFilter" onchange="filterTickets()">
                                    <option value="">ุฌููุน ุงูุฃููุงุน</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <label>ุงูุญุงูุฉ:</label>
                                <select id="ticketsStatusFilter" onchange="filterTickets()">
                                    <option value="">ุฌููุน ุงูุญุงูุงุช</option>
                                    <option value="pending">ูุนููุฉ</option>
                                    <option value="in_progress">ููุฏ ุงูุชูููุฐ</option>
                                    <option value="completed">ููุชููุฉ</option>
                                    <option value="postponed">ูุคุฌูุฉ</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <label>ุชุฑุชูุจ ุญุณุจ:</label>
                                <select id="ticketsSortBy" onchange="filterTickets()">
                                    <option value="created_at">ุงูุชุงุฑูุฎ</option>
                                    <option value="ticket_number">ุฑูู ุงูุชุฐูุฑุฉ</option>
                                    <option value="team_name">ุงููุฑูู</option>
                                    <option value="net_points">ุงูููุงุท</option>
                                    <option value="actual_time_minutes">ุงูููุช ุงููุนูู</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <label>ุงูุงุชุฌุงู:</label>
                                <select id="ticketsSortOrder" onchange="filterTickets()">
                                    <option value="DESC">ุชูุงุฒูู</option>
                                    <option value="ASC">ุชุตุงุนุฏู</option>
                                </select>
                            </div>
                            <button class="btn btn-secondary" onclick="resetFilters()">ุฅุนุงุฏุฉ ุชุนููู</button>
                        </div>
                        <div class="table-container">
                            <table id="ticketsTable">
                                <thead>
                                    <tr>
                                        <th onclick="sortTickets('ticket_number')" style="cursor: pointer;">ุฑูู ุงูุชุฐูุฑุฉ โ</th>
                                        <th onclick="sortTickets('ticket_type_name')" style="cursor: pointer;">ุงูููุน โ</th>
                                        <th onclick="sortTickets('team_name')" style="cursor: pointer;">ุงููุฑูู โ</th>
                                        <th onclick="sortTickets('status')" style="cursor: pointer;">ุงูุญุงูุฉ โ</th>
                                        <th onclick="sortTickets('actual_time_minutes')" style="cursor: pointer;">ุงูููุช ุงููุนูู โ</th>
                                        <th onclick="sortTickets('net_points')" style="cursor: pointer;">ุงูููุงุท โ</th>
                                        <th onclick="sortTickets('created_at')" style="cursor: pointer;">ุงูุชุงุฑูุฎ โ</th>
                                    </tr>
                                </thead>
                                <tbody id="ticketsTableBody">
                                    <tr>
                                        <td colspan="7" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div id="ticketsPagination" style="margin-top: 20px; text-align: center;"></div>
                    </div>
                </div>
            </div>

            <!-- Points Management Page -->
            <div id="points-management-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุงุฑุฉ ุงูููุงุท</h2>
                        <p style="margin: 10px 0 0 0; color: var(--text-secondary); font-size: 14px;">
                            ููููู ุฅุฏุฎุงู ูุชุนุฏูู ุงูููุงุท ูุฏููุงู ููู ุชุฐูุฑุฉ
                        </p>
                    </div>
                    <div class="card-body">
                        <div class="filters-bar" style="margin-bottom: 20px; display: flex; flex-wrap: wrap; gap: 10px; align-items: center;">
                            <div class="form-group" style="margin: 0;">
                                <label>ุงูุจุญุซ:</label>
                                <input type="text" id="pointsSearch" placeholder="ุงุจุญุซ ูู ุฑูู ุงูุชุฐูุฑุฉ..." onkeyup="filterPointsTickets()" style="width: 250px;">
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <label>ุงูุชุงุฑูุฎ:</label>
                                <input type="date" id="pointsDateFilter" onchange="filterPointsTickets()">
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <label>ุงููุฑูู:</label>
                                <select id="pointsTeamFilter" onchange="filterPointsTickets()">
                                    <option value="">ุฌููุน ุงููุฑู</option>
                                </select>
                            </div>
                            <button class="btn btn-secondary" onclick="resetPointsFilters()">ุฅุนุงุฏุฉ ุชุนููู</button>
                        </div>
                        <div class="table-container">
                            <table id="pointsTicketsTable">
                                <thead>
                                    <tr>
                                        <th>ุฑูู ุงูุชุฐูุฑุฉ</th>
                                        <th>ุงูููุน</th>
                                        <th>ุงููุฑูู</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุงูููุช ุงููุนูู</th>
                                        <th>ุงูููุงุท ุงูููุงุฆูุฉ</th>
                                        <th>ุงููุฏูุฑ</th>
                                        <th>ุงูุชุงุฑูุฎ</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="pointsTicketsTableBody">
                                    <tr>
                                        <td colspan="9" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div id="pointsPagination" style="margin-top: 20px; text-align: center;"></div>
                    </div>
                </div>
            </div>

            <!-- Scoring Rules Settings Page -->
            <div id="scoring-rules-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>โ๏ธ ููุงุนุฏ ุงูููุงุท (Scoring Rules)</h2>
                        <p style="color: var(--text-muted); margin-top: 10px;">ูุฐู ุงูููุงุนุฏ ุชุทุจู ุชููุงุฆูุงู ุนูู ุฌููุน ุงูุชุฐุงูุฑ. ุชุนุฏูู ุงูููุงุนุฏ ูุคุซุฑ ุนูู ุงูุชุฐุงูุฑ ุงูุฌุฏูุฏุฉ ููุท.</p>
                    </div>
                    <div class="card-body">
                        <!-- ุงูููุงุท ุงูุฃุณุงุณูุฉ ุญุณุจ ููุน ุงูุชุฐูุฑุฉ -->
                        <div class="card" style="margin-bottom: 30px;">
                            <div class="card-header">
                                <h3>ุฃ) ุงูููุงุท ุงูุฃุณุงุณูุฉ ุญุณุจ ููุน ุงูุชุฐูุฑุฉ</h3>
                            </div>
                            <div class="card-body">
                                <div id="ticket-type-base-points-container">
                                    <p class="loading">ุฌุงุฑู ุงูุชุญููู...</p>
                                </div>
                            </div>
                        </div>

                        <!-- ููุงุท ุงูููุช (Speed Points) -->
                        <div class="card" style="margin-bottom: 30px;">
                            <div class="card-header">
                                <h3>ุจ) ููุงุท ุงูููุช (Speed Points)</h3>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label>ุถูู ุงูููุช ุงููุซุงูู (ุถูู SLA):</label>
                                    <input type="number" id="speed-points-excellent" class="form-control" min="0" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label>ุชุฌุงูุฒ ุจุณูุท (ุญุชู 1.5 ร SLA):</label>
                                    <input type="number" id="speed-points-acceptable" class="form-control" min="0" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label>ูุชุฃุฎุฑ (ุฃูุซุฑ ูู 1.5 ร SLA):</label>
                                    <input type="number" id="speed-points-late" class="form-control" min="0" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label>ูุนุงูู ุชุฌุงูุฒ SLA:</label>
                                    <input type="number" id="speed-sla-multiplier" class="form-control" min="1" step="0.1" value="1.5">
                                    <small>ุงููุนุงูู ุงููุณุชุฎุฏู ูุชุญุฏูุฏ "ุงูุชุฌุงูุฒ ุงูุจุณูุท" (ูุซูุงู: 1.5 ูุนูู 150% ูู SLA)</small>
                                </div>
                                <button class="btn btn-primary" onclick="saveSpeedPointsRules()">๐พ ุญูุธ ููุงุนุฏ ุงูููุช</button>
                            </div>
                        </div>

                        <!-- ููุงุท Checklist (ุงูุตูุฑ) -->
                        <div class="card" style="margin-bottom: 30px;">
                            <div class="card-header">
                                <h3>ุฌ) ููุงุท ุงูุตูุฑ/Checklist</h3>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label>ููุงุท ูู ุตูุฑุฉ/ุชุงุณู ููุชูู:</label>
                                    <input type="number" id="checklist-item-points" class="form-control" min="0" step="0.01">
                                    <small>ูู ุตูุฑุฉ ุฃู ุชุงุณู ููุชูู ูู Checklist = X ููุงุท</small>
                                </div>
                                <button class="btn btn-primary" onclick="saveChecklistPointsRule()">๐พ ุญูุธ ูุงุนุฏุฉ Checklist</button>
                            </div>
                        </div>

                        <!-- ุฎุตู ุชูููู ุฃุฏุงุก ุงููุฑูู -->
                        <div class="card" style="margin-bottom: 30px;">
                            <div class="card-header">
                                <h3>ุฏ) ุฎุตู ุชูููู ุฃุฏุงุก ุงููุฑูู</h3>
                                <p style="color: var(--text-muted); font-size: 14px; margin-top: 10px;">ุงูุฎุตู ูุทุจู ุนูู ูุฌููุน ููุงุท ุงูุชุฐูุฑุฉ (ููู ุณุงูุจุฉ)</p>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label>ููุชุงุฒ (5):</label>
                                    <input type="number" id="performance-rating-5" class="form-control" value="0" min="-999" max="0" step="0.01">
                                    <small>ูุง ุฎุตู</small>
                                </div>
                                <div class="form-group">
                                    <label>ุฌูุฏ (4):</label>
                                    <input type="number" id="performance-rating-4" class="form-control" value="0" min="-999" max="0" step="0.01">
                                    <small>ูุง ุฎุตู</small>
                                </div>
                                <div class="form-group">
                                    <label>ุนุงุฏู (3):</label>
                                    <input type="number" id="performance-rating-3" class="form-control" value="-1" min="-999" max="0" step="0.01">
                                    <small>ุฎุตู ููุทุฉ ูุงุญุฏุฉ</small>
                                </div>
                                <div class="form-group">
                                    <label>ุถุนูู (2):</label>
                                    <input type="number" id="performance-rating-2" class="form-control" value="-2" min="-999" max="0" step="0.01">
                                    <small>ุฎุตู ููุทุชูู</small>
                                </div>
                                <div class="form-group">
                                    <label>ุถุนูู ุฌุฏุงู (1):</label>
                                    <input type="number" id="performance-rating-1" class="form-control" value="-3" min="-999" max="0" step="0.01">
                                    <small>ุฎุตู 3 ููุงุท</small>
                                </div>
                                <button class="btn btn-primary" onclick="savePerformanceRatingRules()">๐พ ุญูุธ ููุงุนุฏ ุงูุชูููู</button>
                            </div>
                        </div>

                        <!-- ููุงุท ุงูุจูุน (Upsell) -->
                        <div class="card" style="margin-bottom: 30px;">
                            <div class="card-header">
                                <h3>ูู) ููุงุท ุงูุจูุน (Upsell)</h3>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label>ููุงุท ุจูุน Router:</label>
                                    <input type="number" id="upsell-router" class="form-control" min="0" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label>ููุงุท ุจูุน ONU:</label>
                                    <input type="number" id="upsell-onu" class="form-control" min="0" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label>ููุงุท ุจูุน UPS:</label>
                                    <input type="number" id="upsell-ups" class="form-control" min="0" step="0.01">
                                </div>
                                <button class="btn btn-primary" onclick="saveUpsellRules()">๐พ ุญูุธ ููุงุนุฏ ุงูุจูุน</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="reports-page" class="page-content" style="display: none;">
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-header">
                        <h2>ุงูุชูุงุฑูุฑ ุงูููููุฉ</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="reportDate">ุงุฎุชุฑ ุงูุชุงุฑูุฎ:</label>
                            <input type="date" id="reportDate" value="">
                            <button class="btn btn-primary" onclick="generateDailyReport()" style="margin-right: 10px;">ุชูููุฏ ุชูุฑูุฑ PDF</button>
                        </div>
                        <div id="reportResult" style="margin-top: 20px;"></div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2>ุชุตุฏูุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช</h2>
                    </div>
                    <div class="card-body">
                        <p>ุงุฎุชุฑ ุงูุฌุฏุงูู ุงูุชู ุชุฑูุฏ ุชุตุฏูุฑูุง:</p>
                        <div id="exportTablesList" style="margin: 20px 0;"></div>
                        <button class="btn btn-primary" onclick="exportDatabase()">ุชุตุฏูุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช</button>
                        <div id="exportResult" style="margin-top: 20px;"></div>
                    </div>
                </div>
            </div>

            <!-- Users Management Page -->
            <div id="users-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h2>
                        <button class="btn btn-primary" onclick="showAddUserForm()">โ ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ</button>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="usersTable">
                                <thead>
                                    <tr>
                                        <th>ุงุณู ุงููุณุชุฎุฏู</th>
                                        <th>ุงูุงุณู ุงููุงูู</th>
                                        <th>ุงููุฑูู</th>
                                        <th>ุงูุฏูุฑ</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุชุงุฑูุฎ ุงูุฅูุดุงุก</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <tr>
                                        <td colspan="7" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Add/Edit User Modal -->
                <div id="userModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
                    <div style="background: var(--card-bg); padding: 30px; border-radius: 12px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
                        <h2 id="userModalTitle" style="margin-bottom: 20px;">ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ</h2>
                        <form id="userForm">
                            <input type="hidden" id="edit_user_id">
                            <div class="form-group">
                                <label for="user_username">ุงุณู ุงููุณุชุฎุฏู *</label>
                                <input type="text" id="user_username" required>
                            </div>
                            <div class="form-group">
                                <label for="user_password" id="user_password_label">ูููุฉ ุงููุฑูุฑ *</label>
                                <input type="password" id="user_password" required>
                                <small style="color: var(--text-muted); font-size: 12px;">ุงุชุฑูู ูุงุฑุบุงู ุฅุฐุง ููุช ุชุนุฏู ููุง ุชุฑูุฏ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ</small>
                            </div>
                            <div class="form-group">
                                <label for="user_full_name">ุงูุงุณู ุงููุงูู *</label>
                                <input type="text" id="user_full_name" required>
                            </div>
                            <div class="form-group">
                                <label style="margin-bottom: 15px; display: block; font-weight: 600; font-size: 16px;">ููุน ุงูููุธู *</label>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                                    <div class="role-option" style="padding: 20px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 12px; cursor: pointer; transition: all var(--transition-base);" onclick="selectRoleType('quality_staff')" data-role="quality_staff">
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
                                            <input type="radio" name="role_type" id="role_quality_staff" value="quality_staff" onchange="selectRoleType('quality_staff')" style="width: 20px; height: 20px; cursor: pointer;">
                                            <label for="role_quality_staff" style="margin: 0; cursor: pointer; font-weight: 600; font-size: 16px; flex: 1;">ููุธู ุงูุฌูุฏุฉ</label>
                                        </div>
                                        <p style="margin: 0; color: var(--text-muted); font-size: 13px; line-height: 1.6;">ูุฑุงุฌุนุฉ ูุชูููู ุฌูุฏุฉ ุงูุชุฐุงูุฑ ุงูููุชููุฉ</p>
                                    </div>
                                    <div class="role-option" style="padding: 20px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 12px; cursor: pointer; transition: all var(--transition-base);" onclick="selectRoleType('technician')" data-role="technician">
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
                                            <input type="radio" name="role_type" id="role_technician" value="technician" onchange="selectRoleType('technician')" style="width: 20px; height: 20px; cursor: pointer;">
                                            <label for="role_technician" style="margin: 0; cursor: pointer; font-weight: 600; font-size: 16px; flex: 1;">ููู</label>
                                        </div>
                                        <p style="margin: 0; color: var(--text-muted); font-size: 13px; line-height: 1.6;">ุชูููุฐ ูุฅููุงู ุงูุชุฐุงูุฑ ุงููุฎุตุตุฉ ูู</p>
                                    </div>
                                    <div class="role-option" style="padding: 20px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 12px; cursor: pointer; transition: all var(--transition-base);" onclick="selectRoleType('custom')" data-role="custom">
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
                                            <input type="radio" name="role_type" id="role_custom" value="custom" onchange="selectRoleType('custom')" style="width: 20px; height: 20px; cursor: pointer;">
                                            <label for="role_custom" style="margin: 0; cursor: pointer; font-weight: 600; font-size: 16px; flex: 1;">ุตูุงุญูุงุช ูุฎุตุตุฉ</label>
                                        </div>
                                        <p style="margin: 0; color: var(--text-muted); font-size: 13px; line-height: 1.6;">ุงุฎุชุฑ ุงูุตูุงุญูุงุช ูุฏููุงู</p>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group" id="permissions_custom_section" style="display: none;">
                                <label style="margin-bottom: 15px; display: block; font-weight: 600; font-size: 16px;">ุงูุตูุงุญูุงุช ุงููุฎุตุตุฉ</label>
                                <div style="display: flex; flex-wrap: wrap; gap: 12px; padding: 20px; background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border-color);">
                                    <label class="permission-checkbox-item" for="perm_create_tickets" style="display: flex; align-items: center; gap: 10px; padding: 14px 18px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 10px; cursor: pointer; transition: all var(--transition-base); flex: 1; min-width: 180px; margin: 0;">
                                        <input type="checkbox" id="perm_create_tickets" onchange="updatePermissions()" style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-color);">
                                        <span style="font-weight: 500; color: var(--text-primary); user-select: none;">ุฅูุดุงุก ุงูุชุฐุงูุฑ</span>
                                    </label>
                                    <label class="permission-checkbox-item" for="perm_manage_tickets" style="display: flex; align-items: center; gap: 10px; padding: 14px 18px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 10px; cursor: pointer; transition: all var(--transition-base); flex: 1; min-width: 180px; margin: 0;">
                                        <input type="checkbox" id="perm_manage_tickets" onchange="updatePermissions()" style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-color);">
                                        <span style="font-weight: 500; color: var(--text-primary); user-select: none;">ุฅุฏุงุฑุฉ ุงูุชุฐุงูุฑ</span>
                                    </label>
                                    <label class="permission-checkbox-item" for="perm_review_quality" style="display: flex; align-items: center; gap: 10px; padding: 14px 18px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 10px; cursor: pointer; transition: all var(--transition-base); flex: 1; min-width: 180px; margin: 0;">
                                        <input type="checkbox" id="perm_review_quality" onchange="updatePermissions()" style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-color);">
                                        <span style="font-weight: 500; color: var(--text-primary); user-select: none;">ูุฑุงุฌุนุฉ ุงูุฌูุฏุฉ</span>
                                    </label>
                                    <label class="permission-checkbox-item" for="perm_execute_tickets" style="display: flex; align-items: center; gap: 10px; padding: 14px 18px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 10px; cursor: pointer; transition: all var(--transition-base); flex: 1; min-width: 180px; margin: 0;">
                                        <input type="checkbox" id="perm_execute_tickets" onchange="updatePermissions()" style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-color);">
                                        <span style="font-weight: 500; color: var(--text-primary); user-select: none;">ุชูููุฐ ุงูุชุฐุงูุฑ</span>
                                    </label>
                                    <label class="permission-checkbox-item" for="perm_manage_teams" style="display: flex; align-items: center; gap: 10px; padding: 14px 18px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 10px; cursor: pointer; transition: all var(--transition-base); flex: 1; min-width: 180px; margin: 0;">
                                        <input type="checkbox" id="perm_manage_teams" onchange="updatePermissions()" style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-color);">
                                        <span style="font-weight: 500; color: var(--text-primary); user-select: none;">ุฅุฏุงุฑุฉ ุงููุฑู</span>
                                    </label>
                                    <label class="permission-checkbox-item" for="perm_view_reports" style="display: flex; align-items: center; gap: 10px; padding: 14px 18px; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 10px; cursor: pointer; transition: all var(--transition-base); flex: 1; min-width: 180px; margin: 0;">
                                        <input type="checkbox" id="perm_view_reports" onchange="updatePermissions()" style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-color);">
                                        <span style="font-weight: 500; color: var(--text-primary); user-select: none;">ุนุฑุถ ุงูุชูุงุฑูุฑ</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group" id="permissions_quality_section" style="display: none;">
                                <label style="margin-bottom: 15px; display: block; font-weight: 600; font-size: 16px;">ุตูุงุญูุงุช ููุธู ุงูุฌูุฏุฉ</label>
                                <div style="padding: 20px; background: var(--bg-secondary); border-radius: 8px; border-right: 4px solid var(--success-color);">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--success-color);">
                                            <polyline points="20 6 9 17 4 12"></polyline>
                                        </svg>
                                        <span style="font-weight: 600;">ูุฑุงุฌุนุฉ ูุชูููู ุฌูุฏุฉ ุงูุชุฐุงูุฑ ุงูููุชููุฉ</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--success-color);">
                                            <polyline points="20 6 9 17 4 12"></polyline>
                                        </svg>
                                        <span>ุนุฑุถ ุฌููุน ุงูุชุฐุงูุฑ ุงูููุชููุฉ</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--success-color);">
                                            <polyline points="20 6 9 17 4 12"></polyline>
                                        </svg>
                                        <span>ุฅุถุงูุฉ ุชููููุงุช ูููุงุท ููุฌูุฏุฉ</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group" id="permissions_technician_section" style="display: none;">
                                <label style="margin-bottom: 15px; display: block; font-weight: 600; font-size: 16px;">ุตูุงุญูุงุช ุงูููู</label>
                                <div style="padding: 20px; background: var(--bg-secondary); border-radius: 8px; border-right: 4px solid var(--primary-color);">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--primary-color);">
                                            <polyline points="20 6 9 17 4 12"></polyline>
                                        </svg>
                                        <span style="font-weight: 600;">ุชูููุฐ ูุฅููุงู ุงูุชุฐุงูุฑ ุงููุฎุตุตุฉ ูู</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--primary-color);">
                                            <polyline points="20 6 9 17 4 12"></polyline>
                                        </svg>
                                        <span>ุนุฑุถ ุงูุชุฐุงูุฑ ุงููุฎุตุตุฉ ููุฑููู</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--primary-color);">
                                            <polyline points="20 6 9 17 4 12"></polyline>
                                        </svg>
                                        <span>ุฑูุน ุงูุตูุฑ ูุฅููุงู Checklist</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group" id="user_team_group" style="display: none;">
                                <label for="user_team_id">ุงููุฑูู</label>
                                <select id="user_team_id">
                                    <option value="">ุงุฎุชุฑ ุงููุฑูู</option>
                                </select>
                                <small id="user_team_hint" style="color: var(--text-muted); font-size: 12px;"></small>
                            </div>
                            <input type="hidden" id="user_role" value="">
                            <div class="form-group">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="user_is_active" checked>
                                    <label for="user_is_active">ุงูุญุณุงุจ ูุดุท</label>
                                </div>
                            </div>
                            <div class="btn-group">
                                <button type="submit" class="btn btn-primary">ุญูุธ</button>
                                <button type="button" class="btn btn-secondary" onclick="closeUserModal()">ุฅูุบุงุก</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Add Ticket Page -->
            <div id="add-ticket-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุฎุงู ุชุฐูุฑุฉ ุฌุฏูุฏ</h2>
                    </div>
                    <div class="card-body">
                        <form id="adminTicketForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="admin_ticket_number">ุฑูู ุงูุชุฐูุฑุฉ *</label>
                                    <input type="text" id="admin_ticket_number" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="admin_ticket_type_id">ููุน ุงูุชุฐูุฑุฉ *</label>
                                    <select id="admin_ticket_type_id" required>
                                        <option value="">ุงุฎุชุฑ ุงูููุน</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="admin_team_id">ุงููุฑูู *</label>
                                    <select id="admin_team_id" required>
                                        <option value="">ุงุฎุชุฑ ุงููุฑูู</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="admin_subscriber_name">ุงุณู ุงููุดุชุฑู</label>
                                    <input type="text" id="admin_subscriber_name">
                                </div>
                                
                                <div class="form-group">
                                    <label for="admin_subscriber_phone">ุฑูู ุงููุดุชุฑู</label>
                                    <input type="text" id="admin_subscriber_phone">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="admin_subscriber_address">ุนููุงู ุงููุดุชุฑู</label>
                                <textarea id="admin_subscriber_address" rows="2"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="admin_notes">ููุงุญุธุงุช</label>
                                <textarea id="admin_notes" rows="3"></textarea>
                            </div>
                            
                            <div class="btn-group">
                                <button type="submit" class="btn btn-primary">ุญูุธ ุงูุชุฐูุฑุฉ</button>
                                <button type="button" class="btn btn-secondary" onclick="resetAdminTicketForm()">ุฅุนุงุฏุฉ ุชุนููู</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Ticket Details Section (for adding photos and quality review) -->
                <div id="admin-ticket-details-section" style="display: none; margin-top: 30px;">
                    <div class="card">
                        <div class="card-header">
                            <h2>ุชูุงุตูู ุงูุชุฐูุฑุฉ #<span id="admin-detail-ticket-number"></span></h2>
                        </div>
                        <div class="card-body">
                            <!-- Photos Section -->
                            <div style="margin-bottom: 30px;">
                                <h3>ุฑูุน ุงูุตูุฑ</h3>
                                <div class="form-group">
                                    <label>ููุน ุงูุตูุฑุฉ</label>
                                    <select id="admin_photo_type">
                                        <option value="pole_before">ูุงุช ุงูุนุงููุฏ ูุจู</option>
                                        <option value="pole_after">ูุงุช ุงูุนุงููุฏ ุจุนุฏ</option>
                                        <option value="pppoe">PPPoE</option>
                                        <option value="equipment_location">ููุงู ุงูุฃุฌูุฒุฉ</option>
                                        <option value="subscriber_power">ุจูุฑ ุงููุดุชุฑู</option>
                                        <option value="dhcp_status">ูุถุน DHCP</option>
                                        <option value="speed_test">ุณุจูุฏ ุชูุณุช</option>
                                        <option value="google_bank">ุจูู ุฌูุฌู</option>
                                        <option value="activation_message">ุฑุณุงูุฉ ุงูุชูุนูู</option>
                                        <option value="rx_power">RX Power</option>
                                    </select>
                                </div>
                                <div class="photo-upload-area" id="adminPhotoUploadArea">
                                    <p>ุงุณุญุจ ุงูุตูุฑ ููุง ุฃู ุงุถุบุท ููุงุฎุชูุงุฑ</p>
                                    <input type="file" id="adminPhotoInput" multiple accept="image/*" style="display: none;">
                                </div>
                                <div class="photo-grid" id="adminPhotoGrid"></div>
                            </div>

                            <!-- Quality Review Section -->
                            <div style="margin-bottom: 30px;">
                                <h3>ุชูููู ุงูุฌูุฏุฉ</h3>
                                <form id="adminQualityReviewForm">
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label for="admin_contact_status">ุญุงูุฉ ุงูุงุชุตุงู *</label>
                                            <select id="admin_contact_status" required>
                                                <option value="answered">ุชู ุงูุฑุฏ</option>
                                                <option value="no_answer">ูู ูุฑุฏ</option>
                                                <option value="closed">ูุบูู</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="admin_service_status">ุญุงูุฉ ุงูุฎุฏูุฉ *</label>
                                            <select id="admin_service_status" required>
                                                <option value="excellent">ููุชุงุฒ</option>
                                                <option value="good">ุฌูุฏ</option>
                                                <option value="poor">ุฑุฏูุก</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="admin_team_rating">ุชูููู ุฃุฏุงุก ุงููุฑูู (1-5) *</label>
                                            <input type="number" id="admin_team_rating" min="1" max="5" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="admin_subscription_amount">ูุจูุบ ุงูุงุดุชุฑุงู</label>
                                            <input type="number" id="admin_subscription_amount" step="0.01">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>ุงูุฎุฏูุงุช ุงููุดุฑูุญุฉ ูููุดุชุฑู:</label>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_explained_sinmana">
                                            <label for="admin_explained_sinmana">ุณูููุงูุง</label>
                                        </div>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_explained_platform">
                                            <label for="admin_explained_platform">ููุตุฉ</label>
                                        </div>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_explained_mytv_plus">
                                            <label for="admin_explained_mytv_plus">MyTV+</label>
                                        </div>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_explained_shahid_plus">
                                            <label for="admin_explained_shahid_plus">ุดุงูุฏ ุจูุณ</label>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_whatsapp_group_interest">
                                            <label for="admin_whatsapp_group_interest">ูุฑุบุจ ุจุงูุงูุถูุงู ููุฑูุจ ุงููุงุชุณุงุจ</label>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_needs_followup">
                                            <label for="admin_needs_followup">ูุญุชุงุฌ ูุชุงุจุนุฉ</label>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group" id="adminFollowupReasonGroup" style="display: none;">
                                        <label for="admin_followup_reason">ุณุจุจ ุงููุชุงุจุนุฉ</label>
                                        <select id="admin_followup_reason">
                                            <option value="amount_mismatch">ูุจูุบ ุบูุฑ ูุชุทุงุจู</option>
                                            <option value="technical_issue">ูุดููุฉ ูููุฉ</option>
                                            <option value="violation">ุชุฌุงูุฒ</option>
                                            <option value="complaint">ุดููู</option>
                                            <option value="poor_service">ุฎุฏูุฉ ุฑุฏูุฆุฉ</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="admin_review_notes">ููุงุญุธุงุช ุงูุฌูุฏุฉ</label>
                                        <textarea id="admin_review_notes" rows="3"></textarea>
                                    </div>
                                    
                                    <div class="btn-group">
                                        <button type="submit" class="btn btn-primary">ุญูุธ ุงูุชูููู</button>
                                        <button type="button" class="btn btn-success" onclick="generateAdminMessage()">ุชูููุฏ ุฑุณุงูุฉ</button>
                                    </div>
                                </form>
                            </div>

                            <!-- Generated Message -->
                            <div id="adminMessageSection" style="display: none;">
                                <h3>ุงูุฑุณุงูุฉ ุงูุฌุงูุฒุฉ</h3>
                                <div class="message-box">
                                    <textarea id="adminGeneratedMessage" readonly></textarea>
                                    <button class="btn btn-copy" onclick="copyAdminMessage()">ูุณุฎ ุงูุฑุณุงูุฉ</button>
                                </div>
                            </div>

                            <!-- Scores Display -->
                            <div id="adminScoresSection" style="margin-top: 30px;">
                                <h3>ุงูููุงุท</h3>
                                <div class="score-display" id="adminScoreDisplay"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Points Management Modal -->
    <div id="points-management-modal" class="modal-overlay">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <h2>ุฅุฏุงุฑุฉ ููุงุท ุงูุชุฐูุฑุฉ #<span id="points-ticket-number"></span></h2>
                <button class="modal-close-btn" onclick="closePointsManagementModal()">ร</button>
            </div>
            <div class="modal-body">
                <!-- ูุนูููุงุช ุงูุชุฐูุฑุฉ -->
                <div class="info-section" style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 25px;">
                    <h3 style="margin-bottom: 15px; color: var(--text-primary);">ูุนูููุงุช ุงูุชุฐูุฑุฉ</h3>
                    <div class="form-grid">
                        <div>
                            <strong>ููุน ุงูุชุฐูุฑุฉ:</strong> <span id="points-ticket-type"></span>
                        </div>
                        <div>
                            <strong>ุชุงุฑูุฎ ุงูุงุณุชูุงู (T0):</strong> <span id="points-time-received"></span>
                        </div>
                        <div>
                            <strong>ุชุงุฑูุฎ ุฃูู ุฑุฏ (T1):</strong> <span id="points-time-first-contact"></span>
                        </div>
                        <div>
                            <strong>ุชุงุฑูุฎ ุงูุฅููุงู (T2):</strong> <span id="points-time-completed"></span>
                        </div>
                        <div>
                            <strong>ุงูููุช ุงููุนูู:</strong> <span id="points-actual-time"></span> ุณุงุนุฉ
                        </div>
                    </div>
                    <div id="points-time-info"></div>
                </div>
                
                <!-- ุงูููุงุท ุงูููุชุณุจุฉ -->
                <div class="points-section">
                    <h3 style="color: var(--success-color); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <span>โ</span>
                        <span>ุงูููุงุท ุงูููุชุณุจุฉ</span>
                    </h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ุงูููุงุท ุงูุฃุณุงุณูุฉ</label>
                            <input type="number" id="base_points" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ุงูููุงุท ุงูุฃุณุงุณูุฉ ุญุณุจ ููุน ุงูุชุฐูุฑุฉ</small>
                        </div>
                        <div class="form-group">
                            <label>ููุงุท ุงูููุช</label>
                            <input type="number" id="time_points" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ููุงุท ุงูููุช ุจูุงุกู ุนูู SLA</small>
                        </div>
                        <div class="form-group">
                            <label>ุฅุฌูุงูู ููุงุท Checklist</label>
                            <input type="number" id="quality_points" min="0" step="0.01" class="form-control" readonly>
                            <small style="color: var(--text-muted);">ูุชู ุญุณุงุจู ุชููุงุฆูุงู ูู ููุงุท ุงูุชุงุณูุงุช ุฃุฏูุงู</small>
                        </div>
                        <div class="form-group">
                            <label>ููุงุท ุงูุจูุน (Upsell)</label>
                            <input type="number" id="upsell_points" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ููุงุท ุงูุจูุน ุงูุฅุถุงููุฉ</small>
                        </div>
                        <div class="form-group">
                            <label>ููุงุท ุฅุถุงููุฉ (Bonus)</label>
                            <input type="number" id="bonus_points" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ููุงุท ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)</small>
                        </div>
                    </div>
                    <div style="padding: 15px; background: rgba(16, 185, 129, 0.1); border-right: 4px solid var(--success-color); border-radius: 8px; margin-top: 20px;">
                        <strong style="font-size: 16px;">ุฅุฌูุงูู ุงูููุงุท ุงูููุชุณุจุฉ: <span id="total-earned-display">0</span></strong>
                    </div>
                </div>
                
                <!-- ููุงุท Checklist Items -->
                <div class="points-section" style="margin-top: 30px;">
                    <h3 style="color: var(--primary-color); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <span>๐</span>
                        <span>ููุงุท ุงูุชุงุณูุงุช (Checklist Items)</span>
                    </h3>
                    <div id="checklist-items-container" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
                        <p style="grid-column: 1 / -1; color: var(--text-muted); text-align: center; padding: 20px;">
                            ุฌุงุฑู ุชุญููู ูุงุฆูุฉ ุงูุชุงุณูุงุช...
                        </p>
                    </div>
                </div>
                
                <!-- ุงูููุงุท ุงููุฎุตููุฉ -->
                <div class="points-section" style="margin-top: 30px;">
                    <h3 style="color: var(--danger-color); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <span>โ</span>
                        <span>ุงูููุงุท ุงููุฎุตููุฉ</span>
                    </h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ุฎุตู ุงูููุช</label>
                            <input type="number" id="time_penalty" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ุฎุตู ุจุณุจุจ ุงูุชุฃุฎูุฑ ูู ุงูููุช</small>
                        </div>
                        <div class="form-group">
                            <label>ุฎุตู ุงูุชุงุณูุงุช ุบูุฑ ุงูููุชููุฉ</label>
                            <input type="number" id="tasks_penalty" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ุฎุตู ููุชุงุณูุงุช ุงูุชู ูู ูุชู ุฅููุงููุง</small>
                        </div>
                        <div class="form-group">
                            <label>ุฎุตู ุงูุฌูุฏุฉ</label>
                            <input type="number" id="quality_penalty" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ุฎุตู ุจุณุจุจ ููุต ูู ุงูุฌูุฏุฉ</small>
                        </div>
                        <div class="form-group">
                            <label>ุฎุตู ุงูุณููู</label>
                            <input type="number" id="behavior_penalty" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ุฎุตู ุจุณุจุจ ุงูุณููู</small>
                        </div>
                        <div class="form-group">
                            <label>ุฎุตููุงุช ุฃุฎุฑู</label>
                            <input type="number" id="other_penalty" min="0" step="0.01" class="form-control">
                            <small style="color: var(--text-muted);">ุฎุตููุงุช ุฅุถุงููุฉ</small>
                        </div>
                        <div class="form-group">
                            <label>ุฎุตู ุชูููู ุฃุฏุงุก ุงููุฑูู</label>
                            <input type="number" id="performance_rating_penalty" min="0" step="0.01" class="form-control" readonly style="background-color: #f0f0f0;">
                            <small style="color: var(--text-muted);">ูุชู ุญุณุงุจูุง ุชููุงุฆูุงู ุญุณุจ ุงูุชูููู ุงููุฎุชุงุฑ</small>
                        </div>
                    </div>
                    <div style="padding: 15px; background: rgba(239, 68, 68, 0.1); border-right: 4px solid var(--danger-color); border-radius: 8px; margin-top: 20px;">
                        <strong style="font-size: 16px;">ุฅุฌูุงูู ุงูููุงุท ุงููุฎุตููุฉ: <span id="total-penalty-display">0</span></strong>
                    </div>
                </div>
                
                <!-- ุงูููุงุท ุงูููุงุฆูุฉ -->
                <div style="padding: 25px; background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%); color: white; border-radius: 8px; margin-top: 30px; text-align: center;">
                    <h2 style="margin: 0; font-size: 28px;">ุงูููุงุท ุงูููุงุฆูุฉ: <span id="final-points-display">0</span></h2>
                </div>
                
                <!-- ุชูููู ุฃุฏุงุก ุงููุฑูู -->
                <div class="points-section" style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px;">โญ ุชูููู ุฃุฏุงุก ุงููุฑูู</h3>
                    <div class="form-group">
                        <label>ุงูุชูููู (1-5)</label>
                        <select id="team_performance_rating" class="form-control" style="max-width: 200px;">
                            <option value="">-- ุงุฎุชุฑ ุงูุชูููู --</option>
                            <option value="1">1 - ุถุนูู ุฌุฏุงู (ุฎุตู 3 ููุงุท)</option>
                            <option value="2">2 - ุถุนูู (ุฎุตู ููุทุชูู)</option>
                            <option value="3">3 - ูุชูุณุท (ุฎุตู ููุทุฉ ูุงุญุฏุฉ)</option>
                            <option value="4">4 - ุฌูุฏ (ูุง ุฎุตู)</option>
                            <option value="5">5 - ููุชุงุฒ (ูุง ุฎุตู)</option>
                        </select>
                        <small style="color: var(--text-muted);">ุชูููู ุฃุฏุงุก ุงููุฑูู ูู ูุฐุง ุงูุชุฐูุฑุฉ - ุณูุชู ุฎุตูู ุชููุงุฆูุงู ูู ุงูููุงุท ุงููุฎุตููุฉ</small>
                    </div>
                </div>
                
                <!-- ููุงุญุธุงุช ุงููุฏูุฑ -->
                <div class="form-group" style="margin-top: 30px;">
                    <label>ููุงุญุธุงุช ุงููุฏูุฑ</label>
                    <textarea id="manager_notes" class="form-control" rows="3" placeholder="ุฃุถู ููุงุญุธุงุช ุนู ุงูููุงุท..."></textarea>
                </div>
                
                <!-- ุฃุฒุฑุงุฑ -->
                <div style="display: flex; gap: 12px; margin-top: 30px; justify-content: flex-end;">
                    <button class="btn btn-secondary" onclick="closePointsManagementModal()">ุฅูุบุงุก</button>
                    <button class="btn btn-danger" onclick="deleteTicketPoints()">ุญุฐู ุงูููุงุท</button>
                    <button class="btn btn-primary" onclick="saveTicketPoints()" style="min-width: 150px;">ุญูุธ ุงูููุงุท</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Page -->
    <div id="settings-page" class="page-content" style="display: none;">
        <div class="card">
            <div class="card-header">
                <h2>โ๏ธ ุงูุฅุนุฏุงุฏุงุช</h2>
                <p style="color: var(--text-muted); margin-top: 10px;">ุฅุนุฏุงุฏุงุช ุงููุธุงู ูุงูุฅุดุนุงุฑุงุช</p>
            </div>
            <div class="card-body">
                <!-- Notifications Settings (shared UI injected by /js/settings-notifications.js) -->
                <div id="settingsNotificationsMount"></div>
                
                <div class="form-section">
                    <button type="button" class="accordion-header" onclick="toggleAdminWhatsAppAccordion()" style="width: 100%; text-align: right; padding: 16px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: space-between; margin-bottom: 0;">
                        <h3 class="form-section-title" style="margin: 0; display: flex; align-items: center; gap: 10px;">
                            <span>๐ฑ</span>
                            <span>ุฅุนุฏุงุฏุงุช ุงููุงุชุณุงุจ</span>
                        </h3>
                        <span class="accordion-icon" id="adminWhatsAppAccordionIcon" style="transition: transform 0.3s;">โผ</span>
                    </button>
                    <div id="adminWhatsAppAccordionContent" class="accordion-content" style="display: none; padding: 20px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-top: none; border-radius: 0 0 8px 8px;">
                        <form id="adminWhatsappSettingsForm">
                            <div class="form-group">
                                <label for="admin_whatsapp_phone">ุฑูู ุงููุงุชุณุงุจ <span class="required">*</span></label>
                                <input type="text" id="admin_whatsapp_phone" placeholder="ูุซุงู: 07901234567 ุฃู 9647901234567" required>
                                <small class="form-hint">ุฑูู ุงููุงุชุณุงุจ ุงูุฎุงุต ุจู ูุฅุฑุณุงู ุงูุฑุณุงุฆู</small>
                            </div>
                            
                            <div class="form-group">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="admin_whatsapp_enabled" style="width: auto;">
                                    <span>ุชูุนูู ุฅุฑุณุงู ุฑุณุงุฆู ุงููุงุชุณุงุจ</span>
                                </label>
                                <small class="form-hint">ุนูุฏ ุงูุชูุนููุ ููููู ุฅุฑุณุงู ุฑุณุงุฆู ุงููุงุชุณุงุจ ุนุจุฑ ุงูุจุงุฑููุฏ</small>
                            </div>
                            
                            <div class="form-actions" style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button type="submit" class="btn btn-primary">๐พ ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button>
                                <button type="button" onclick="generateAdminWhatsAppQR()" class="btn btn-success">๐ฑ ุชูููุฏ QR ูุงุชุณุงุจ</button>
                            </div>
                        </form>
                        
                        <div id="adminWhatsappQRContainer" style="margin-top: 24px; display: none; text-align: center; padding: 20px; background: var(--bg-secondary); border-radius: 8px;">
                            <h4 style="margin-bottom: 16px; color: var(--text-primary);">๐ฑ QR Code ูููุงุชุณุงุจ</h4>
                            <div id="adminQRCodeDisplay" style="display: flex; justify-content: center; align-items: center; min-height: 200px;">
                                <p style="color: var(--text-muted);">ุฌุงุฑู ุชูููุฏ QR Code...</p>
                            </div>
                            <button type="button" onclick="logoutAdminWhatsApp()" class="btn btn-danger" style="margin-top: 16px;">๐ช ุชุณุฌูู ุงูุฎุฑูุฌ ูู WhatsApp</button>
                        </div>
                        
                        <div id="adminWhatsappStatusIndicator" style="margin-top: 24px; padding: 16px; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color); display: none;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span id="adminWhatsappStatusIcon">โ</span>
                                <span id="adminWhatsappStatusText">ูุงุชุณุงุจ ุบูุฑ ูุฑุจูุท</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Templates Management Section -->
                <div class="form-section" style="margin-top: 24px;">
                    <button type="button" class="accordion-header" onclick="toggleTemplatesAccordion()" style="width: 100%; text-align: right; padding: 16px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: space-between; margin-bottom: 0;">
                        <h3 class="form-section-title" style="margin: 0; display: flex; align-items: center; gap: 10px;">
                            <span>๐</span>
                            <span>ุฅุฏุงุฑุฉ ููุงูุจ ุงูุฑุณุงุฆู</span>
                        </h3>
                        <span class="accordion-icon" id="templatesAccordionIcon" style="transition: transform 0.3s;">โผ</span>
                    </button>
                    <div id="templatesAccordionContent" class="accordion-content" style="display: none; padding: 20px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-top: none; border-radius: 0 0 8px 8px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <p style="color: var(--text-secondary); margin: 0; font-size: 14px;">
                                ุฅูุดุงุก ูุฅุฏุงุฑุฉ ููุงูุจ ุงูุฑุณุงุฆู ูููุดุชุฑููู ูุงูููููู
                            </p>
                            <button type="button" onclick="openCreateTemplateModal()" class="btn btn-primary">โ ุฅุถุงูุฉ ูุงูุจ ุฌุฏูุฏ</button>
                        </div>
                        <div class="table-container">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: var(--bg-secondary); border-bottom: 2px solid var(--border-color);">
                                        <th style="padding: 12px; text-align: right; font-weight: 600;">ุงุณู ุงููุงูุจ</th>
                                        <th style="padding: 12px; text-align: right; font-weight: 600;">ุงููุฆุฉ</th>
                                        <th style="padding: 12px; text-align: right; font-weight: 600;">ุงูููุน</th>
                                        <th style="padding: 12px; text-align: center; font-weight: 600;">ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="templatesTableBody">
                                    <tr>
                                        <td colspan="4" style="padding: 20px; text-align: center; color: var(--text-muted);">ุฌุงุฑู ุชุญููู ุงูููุงูุจ...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Quality Staff Permissions Section -->
                <div class="form-section" style="margin-top: 24px;">
                    <button type="button" class="accordion-header" onclick="toggleQualityStaffPermissionsAccordion()" style="width: 100%; text-align: right; padding: 16px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: space-between; margin-bottom: 0;">
                        <h3 class="form-section-title" style="margin: 0; display: flex; align-items: center; gap: 10px;">
                            <span>๐ฅ</span>
                            <span>ุฅุฏุงุฑุฉ ุตูุงุญูุงุช ุงูููุธููู</span>
                        </h3>
                        <span class="accordion-icon" id="qualityStaffPermissionsAccordionIcon" style="transition: transform 0.3s;">โผ</span>
                    </button>
                    <div id="qualityStaffPermissionsAccordionContent" class="accordion-content" style="display: none; padding: 20px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-top: none; border-radius: 0 0 8px 8px;">
                        <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                            ุญุฏุฏ ุตูุงุญูุงุช ุงูููุธููู ูุฅุฑุณุงู ุงูุฑุณุงุฆู ููููููู ูุงููุดุชุฑููู
                        </p>
                        <div class="table-container">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: var(--bg-secondary); border-bottom: 2px solid var(--border-color);">
                                        <th style="padding: 12px; text-align: right; font-weight: 600;">ุงุณู ุงูููุธู</th>
                                        <th style="padding: 12px; text-align: right; font-weight: 600;">ุงูุฏูุฑ</th>
                                        <th style="padding: 12px; text-align: center; font-weight: 600;">ุฅุฑุณุงู ููููููู</th>
                                        <th style="padding: 12px; text-align: center; font-weight: 600;">ุฅุฑุณุงู ูููุดุชุฑููู</th>
                                        <th style="padding: 12px; text-align: center; font-weight: 600;">ุฅุฑุณุงู ุนุงู</th>
                                    </tr>
                                </thead>
                                <tbody id="usersPermissionsTableBody">
                                    <tr>
                                        <td colspan="5" style="padding: 20px; text-align: center; color: var(--text-muted);">ุฌุงุฑู ุชุญููู ูุงุฆูุฉ ุงูููุธููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alert-modal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h2 id="alert-title">ุชูุจูู</h2>
                <button class="modal-close-btn" onclick="closeAlertModal()">ร</button>
            </div>
            <div class="modal-body">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <div id="alert-icon" style="font-size: 48px; line-height: 1;">โ๏ธ</div>
                    <p id="alert-message" style="flex: 1; margin: 0; font-size: 16px; line-height: 1.6;"></p>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-primary" onclick="closeAlertModal()" id="alert-ok-btn">ููุงูู</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Ticket Modal (Same as quality-staff) -->
    <div id="create-ticket-modal" class="modal-overlay">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h2>ุฅูุดุงุก ุชุฐูุฑุฉ ุฌุฏูุฏ</h2>
                <button class="modal-close-btn" onclick="closeCreateTicketModal()">ร</button>
            </div>
            <div class="modal-body">
                <form id="createTicketForm">
                    <div class="form-grid">
                        <!-- ุฑูู ุงูุชุฐูุฑุฉ - ุชูููุฏ ุชููุงุฆู (ููุนุฑุถ ููุท) -->
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label for="create_ticket_number">ุฑูู ุงูุชุฐูุฑุฉ</label>
                            <input type="text" id="create_ticket_number" readonly style="background-color: var(--bg-tertiary); color: var(--text-secondary); cursor: not-allowed;">
                            <small class="form-text" style="color: var(--text-muted); font-size: 0.85em;">ุณูุชู ุชูููุฏู ุชููุงุฆูุงู ูู ุงููุธุงู</small>
                        </div>
                        
                        <!-- ุงุณู ุงููุดุชุฑู -->
                        <div class="form-group">
                            <label for="create_subscriber_name">ุงุณู ุงููุดุชุฑู *</label>
                            <input type="text" id="create_subscriber_name" required placeholder="ุฃุฏุฎู ุงุณู ุงููุดุชุฑู">
                        </div>
                        
                        <!-- ุฑูู ุงููุงุชู -->
                        <div class="form-group">
                            <label for="create_subscriber_phone">ุฑูู ุงููุงุชู *</label>
                            <input type="text" id="create_subscriber_phone" pattern="[0-9]{11}" inputmode="numeric" maxlength="11" autocomplete="off" required placeholder="11 ุฑูู">
                            <small class="form-text" style="color: var(--text-muted); font-size: 0.85em;">ูุฌุจ ุฃู ูุญุชูู ุนูู 11 ุฑูู ุฅูุฌููุฒู ููุท (0-9)</small>
                            <div id="create_subscriber_phone_error" class="error-message" style="display: none;"></div>
                        </div>
                        
                        <!-- ููุน ุงูุชุฐูุฑุฉ -->
                        <div class="form-group">
                            <label for="create_ticket_type_id">ููุน ุงูุชุฐูุฑุฉ *</label>
                            <select id="create_ticket_type_id" required onchange="handleTicketTypeChange()">
                                <option value="">ุงุฎุชุฑ ุงูููุน</option>
                            </select>
                        </div>
                        
                        <!-- ููุน ุงูุชุฐูุฑุฉ ุงููุฎุตุต (ูุธูุฑ ููุท ุนูุฏ ุงุฎุชูุงุฑ "ูุฎุตุต") -->
                        <div class="form-group" id="create_custom_ticket_type_group" style="display: none;">
                            <label for="create_custom_ticket_type">ุงูุชุจ ููุน ุงูุชุฐูุฑุฉ ุงููุฎุตุต *</label>
                            <input type="text" id="create_custom_ticket_type" placeholder="ุฃุฏุฎู ููุน ุงูุชุฐูุฑุฉ ุงููุทููุจ">
                        </div>
                        
                        <!-- ุงูููุทูุฉ -->
                        <div class="form-group">
                            <label for="create_region">ุงูููุทูุฉ</label>
                            <input type="text" id="create_region" placeholder="ุฃุฏุฎู ุงูููุทูุฉ">
                        </div>
                        
                        <!-- ุงูููุงุญุธุงุช -->
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label for="create_notes">ููุงุญุธุงุช</label>
                            <textarea id="create_notes" rows="4" placeholder="ุฃุฏุฎู ุฃู ููุงุญุธุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)" style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-family: inherit; resize: vertical;"></textarea>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color); display: flex; gap: 10px; justify-content: flex-end; flex-wrap: wrap;">
                        <button type="button" class="btn btn-secondary" onclick="closeCreateTicketModal()">ุฅูุบุงุก</button>
                        <button type="button" class="btn btn-primary" onclick="saveTicketOnly()">๐พ ุญูุธ ููุท</button>
                        <button type="button" class="btn btn-success" onclick="saveTicketAndNotify()">๐พ ุญูุธ ูุฅุฑุณุงู ุชูุจูู ููููู</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Template Modal (Create/Edit) -->
    <div id="template-modal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="template-modal-title">ุฅุถุงูุฉ ูุงูุจ ุฌุฏูุฏ</h2>
                <button class="modal-close-btn" onclick="closeTemplateModal()">ร</button>
            </div>
            <div class="modal-body">
                <form id="templateForm">
                    <input type="hidden" id="template_id">
                    
                    <div class="form-section">
                        <h3 class="form-section-title">ูุนูููุงุช ุงููุงูุจ ุงูุฃุณุงุณูุฉ</h3>
                        
                        <div class="form-group">
                            <label for="template_title">ุงุณู ุงููุงูุจ <span class="required">*</span></label>
                            <input type="text" id="template_title" required placeholder="ูุซุงู: ูุงูุจ ุงูุชูุงุก ุงุดุชุฑุงู ุงููุดุชุฑู">
                            <small class="form-hint">ุงุณู ูุงุถุญ ูููุงูุจ ูุชุณููู ุงูุชุนุฑู ุนููู</small>
                        </div>
                        
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label for="template_category">ูุฆุฉ ุงููุงูุจ <span class="required">*</span></label>
                                <select id="template_category" required>
                                    <option value="">ุงุฎุชุฑ ุงููุฆุฉ</option>
                                    <option value="subscription_expiry">ุงูุชูุงุก ุงุดุชุฑุงู ุงูุดุฑูุฉ</option>
                                    <option value="subscriber_expiry">ุงูุชูุงุก ุงุดุชุฑุงู ุงููุดุชุฑู</option>
                                    <option value="ticket_notification">ุฅุดุนุงุฑุงุช ุงูุชุฐุงูุฑ</option>
                                    <option value="custom">ูุฎุตุต</option>
                                </select>
                                <small class="form-hint">ููุน ุงููุงูุจ ูุงูุบุฑุถ ููู</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="template_type">ููุน ุงููุงูุจ</label>
                                <select id="template_type">
                                    <option value="custom">ูุฎุตุต</option>
                                    <option value="connection">ุฑุจุท</option>
                                    <option value="maintenance">ุตูุงูุฉ</option>
                                    <option value="postponed">ุชุฃุฌูู</option>
                                    <option value="followup">ูุชุงุจุนุฉ</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="template_description">ูุตู ุงููุงูุจ</label>
                            <textarea id="template_description" rows="2" placeholder="ูุตู ูุฎุชุตุฑ ูููุงูุจ (ุงุฎุชูุงุฑู)"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3 class="form-section-title">ูุต ุงููุงูุจ</h3>
                        
                        <div class="form-group">
                            <label for="template_text">ูุต ุงูุฑุณุงูุฉ <span class="required">*</span></label>
                            <textarea id="template_text" rows="8" required placeholder="ุงูุชุจ ูุต ุงูุฑุณุงูุฉ ููุง... ููููู ุงุณุชุฎุฏุงู ุงููุชุบูุฑุงุช ูุซู {full_name}, {username}, {phone}"></textarea>
                            <small class="form-hint">ุงุณุชุฎุฏู ุงููุชุบูุฑุงุช ุจูู ุงูุฃููุงุณ ุงููุนูููุฉ ูุซู {full_name}, {username}, {phone}</small>
                        </div>
                        
                        <div class="form-group">
                            <label>ุงููุชุบูุฑุงุช ุงููุชุงุญุฉ:</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px; padding: 12px; background: var(--bg-secondary); border-radius: 8px;">
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{username}')">{username}</button>
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{full_name}')">{full_name}</button>
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{name}')">{name}</button>
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{phone}')">{phone}</button>
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{domain}')">{domain}</button>
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{subscription_end_date}')">{subscription_end_date}</button>
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{days_remaining}')">{days_remaining}</button>
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{amount}')">{amount}</button>
                                <button type="button" class="btn btn-sm" onclick="insertVariable('{subscription_type}')">{subscription_type}</button>
                            </div>
                            <small class="form-hint">ุงุถุบุท ุนูู ุงููุชุบูุฑ ูุฅุถุงูุชู ูู ููุถุน ุงููุคุดุฑ</small>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color); display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeTemplateModal()">ุฅูุบุงุก</button>
                        <button type="submit" class="btn btn-primary">๐พ ุญูุธ ุงููุงูุจ</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/menu-config.js"></script>
    <script src="/js/settings-notifications.js"></script>
    <script src="/js/dashboard-nav.js"></script>
    <script src="/js/datetime-picker.js"></script>
    <script src="/js/time-picker.js"></script>
    <script src="/js/admin-dashboard.js"></script>
    <script src="/js/quality-staff.js"></script>
    <script>
        // Remove empty label elements from tickets page card-header
        document.addEventListener('DOMContentLoaded', function() {
            const ticketsPage = document.getElementById('tickets-page');
            if (ticketsPage) {
                const cardHeader = ticketsPage.querySelector('.card-header > div');
                if (cardHeader) {
                    const emptyLabels = cardHeader.querySelectorAll('label');
                    emptyLabels.forEach(label => {
                        if (!label.textContent.trim() && !label.querySelector('input, select, textarea')) {
                            label.remove();
                        }
                    });
                }
            }
        });
    </script>
</body>
</html>

