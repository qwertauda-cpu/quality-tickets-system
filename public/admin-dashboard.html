<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุฅุฏุงุฑุฉ - ูุธุงู ุฅุฏุงุฑุฉ ุงูุชูุชุงุช</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>โ๏ธ ููุญุฉ ุงูุฅุฏุงุฑุฉ</h2>
                <p id="userName"></p>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="active" data-page="dashboard"><i>๐</i> ููุญุฉ ุงูุชุญูู</a></li>
                <li><a href="#" data-page="add-ticket"><i>โ</i> ุฅุถุงูุฉ ุชูุช</a></li>
                <li><a href="#" data-page="users"><i>๐ค</i> ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</a></li>
                <li><a href="#" data-page="teams"><i>๐ฅ</i> ุงููุฑู</a></li>
                <li><a href="#" data-page="tickets"><i>๐ซ</i> ุงูุชูุชุงุช</a></li>
                <li><a href="#" data-page="reports"><i>๐</i> ุงูุชูุงุฑูุฑ</a></li>
                <li><a href="#" onclick="logout(); return false;"><i>๐ช</i> ุชุณุฌูู ุงูุฎุฑูุฌ</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="header">
                <h1 id="pageTitle">ููุญุฉ ุงูุชุญูู</h1>
                <div class="user-info">
                    <span id="currentUser"></span>
                    <a href="#" class="btn-logout" onclick="logout(); return false;">ุชุณุฌูู ุงูุฎุฑูุฌ</a>
                </div>
            </div>

            <div id="dashboard-page" class="page-content">
                <div class="stats-grid" id="statsGrid">
                    <div class="stat-card">
                        <h3>ุฅุฌูุงูู ุงูุชูุชุงุช ุงูููู</h3>
                        <div class="value" id="totalTickets">0</div>
                    </div>
                    <div class="stat-card secondary">
                        <h3>ุงูุชูุชุงุช ุงูููุชููุฉ</h3>
                        <div class="value" id="completedTickets">0</div>
                    </div>
                    <div class="stat-card warning">
                        <h3>ุงูุชูุชุงุช ุงููุนููุฉ</h3>
                        <div class="value" id="pendingTickets">0</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2>ุชุฑุชูุจ ุงููุฑู</h2>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="rankingsTable">
                                <thead>
                                    <tr>
                                        <th>ุงูุชุฑุชูุจ</th>
                                        <th>ุงุณู ุงููุฑูู</th>
                                        <th>ุงูููุงุท ุงูุฅุฌูุงููุฉ</th>
                                        <th>ุนุฏุฏ ุงูุชูุชุงุช</th>
                                        <th>ุงูููุงุท ุงูุตุงููุฉ</th>
                                    </tr>
                                </thead>
                                <tbody id="rankingsTableBody">
                                    <tr>
                                        <td colspan="5" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="teams-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุงููุฑู</h2>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="teamsTable">
                                <thead>
                                    <tr>
                                        <th>ุงุณู ุงููุฑูู</th>
                                        <th>ุงููุฑุฏูุฉ</th>
                                        <th>ุนุฏุฏ ุงูุฃุนุถุงุก</th>
                                        <th>ุญุฏ ุงูุฑุจุท</th>
                                        <th>ุญุฏ ุงูุตูุงูุฉ</th>
                                        <th>ุงูุญุงูุฉ</th>
                                    </tr>
                                </thead>
                                <tbody id="teamsTableBody">
                                    <tr>
                                        <td colspan="6" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tickets-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุงูุชูุชุงุช</h2>
                        <div>
                            <input type="date" id="ticketsDateFilter" style="margin-left: 10px;">
                            <select id="ticketsStatusFilter" style="margin-left: 10px;">
                                <option value="">ุฌููุน ุงูุญุงูุงุช</option>
                                <option value="pending">ูุนููุฉ</option>
                                <option value="in_progress">ููุฏ ุงูุชูููุฐ</option>
                                <option value="completed">ููุชููุฉ</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="ticketsTable">
                                <thead>
                                    <tr>
                                        <th>ุฑูู ุงูุชูุช</th>
                                        <th>ุงูููุน</th>
                                        <th>ุงููุฑูู</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุงูููุช ุงููุนูู</th>
                                        <th>ุงูููุงุท</th>
                                        <th>ุงูุชุงุฑูุฎ</th>
                                    </tr>
                                </thead>
                                <tbody id="ticketsTableBody">
                                    <tr>
                                        <td colspan="7" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="reports-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุงูุชูุงุฑูุฑ</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="reportDate">ุงุฎุชุฑ ุงูุชุงุฑูุฎ:</label>
                            <input type="date" id="reportDate" value="">
                            <button class="btn btn-primary" onclick="generateDailyReport()" style="margin-right: 10px;">ุชูููุฏ ุชูุฑูุฑ PDF</button>
                        </div>
                        <div id="reportResult" style="margin-top: 20px;"></div>
                    </div>
                </div>
            </div>

            <!-- Users Management Page -->
            <div id="users-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h2>
                        <button class="btn btn-primary" onclick="showAddUserForm()">โ ุฅุถุงูุฉ ุนุงูู ุฌุฏูุฏ</button>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="usersTable">
                                <thead>
                                    <tr>
                                        <th>ุงุณู ุงููุณุชุฎุฏู</th>
                                        <th>ุงูุงุณู ุงููุงูู</th>
                                        <th>ุงููุฑูู</th>
                                        <th>ุงูุฏูุฑ</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุชุงุฑูุฎ ุงูุฅูุดุงุก</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <tr>
                                        <td colspan="7" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Add/Edit User Modal -->
                <div id="userModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
                    <div style="background: var(--card-bg); padding: 30px; border-radius: 12px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
                        <h2 id="userModalTitle" style="margin-bottom: 20px;">ุฅุถุงูุฉ ุนุงูู ุฌุฏูุฏ</h2>
                        <form id="userForm">
                            <input type="hidden" id="edit_user_id">
                            <div class="form-group">
                                <label for="user_username">ุงุณู ุงููุณุชุฎุฏู *</label>
                                <input type="text" id="user_username" required>
                            </div>
                            <div class="form-group">
                                <label for="user_password" id="user_password_label">ูููุฉ ุงููุฑูุฑ *</label>
                                <input type="password" id="user_password" required>
                                <small style="color: var(--text-muted); font-size: 12px;">ุงุชุฑูู ูุงุฑุบุงู ุฅุฐุง ููุช ุชุนุฏู ููุง ุชุฑูุฏ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ</small>
                            </div>
                            <div class="form-group">
                                <label for="user_full_name">ุงูุงุณู ุงููุงูู *</label>
                                <input type="text" id="user_full_name" required>
                            </div>
                            <div class="form-group">
                                <label for="user_team_id">ุงููุฑูู *</label>
                                <select id="user_team_id" required>
                                    <option value="">ุงุฎุชุฑ ุงููุฑูู</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="user_is_active" checked>
                                    <label for="user_is_active">ุงูุญุณุงุจ ูุดุท</label>
                                </div>
                            </div>
                            <div class="btn-group">
                                <button type="submit" class="btn btn-primary">ุญูุธ</button>
                                <button type="button" class="btn btn-secondary" onclick="closeUserModal()">ุฅูุบุงุก</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Add Ticket Page -->
            <div id="add-ticket-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุฎุงู ุชูุช ุฌุฏูุฏ</h2>
                    </div>
                    <div class="card-body">
                        <form id="adminTicketForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="admin_ticket_number">ุฑูู ุงูุชูุช *</label>
                                    <input type="text" id="admin_ticket_number" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="admin_ticket_type_id">ููุน ุงูุชูุช *</label>
                                    <select id="admin_ticket_type_id" required>
                                        <option value="">ุงุฎุชุฑ ุงูููุน</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="admin_team_id">ุงููุฑูู *</label>
                                    <select id="admin_team_id" required>
                                        <option value="">ุงุฎุชุฑ ุงููุฑูู</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>ุชุงุฑูุฎ ุงุณุชูุงู ุงูุชูุช (T0) *</label>
                                    <div id="admin_time_received_container"></div>
                                    <div id="admin_time_received_time_container" style="margin-top: 10px;"></div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ุชุงุฑูุฎ ุฃูู ุงุชุตุงู (T1)</label>
                                    <div id="admin_time_first_contact_container"></div>
                                    <div id="admin_time_first_contact_time_container" style="margin-top: 10px;"></div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ุชุงุฑูุฎ ุฑุณุงูุฉ ุงูุชูุนูู (T3)</label>
                                    <div id="admin_time_completed_container"></div>
                                    <div id="admin_time_completed_time_container" style="margin-top: 10px;"></div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="admin_subscriber_name">ุงุณู ุงููุดุชุฑู</label>
                                    <input type="text" id="admin_subscriber_name">
                                </div>
                                
                                <div class="form-group">
                                    <label for="admin_subscriber_phone">ุฑูู ุงููุดุชุฑู</label>
                                    <input type="text" id="admin_subscriber_phone">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="admin_subscriber_address">ุนููุงู ุงููุดุชุฑู</label>
                                <textarea id="admin_subscriber_address" rows="2"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="admin_notes">ููุงุญุธุงุช</label>
                                <textarea id="admin_notes" rows="3"></textarea>
                            </div>
                            
                            <div class="btn-group">
                                <button type="submit" class="btn btn-primary">ุญูุธ ุงูุชูุช</button>
                                <button type="button" class="btn btn-secondary" onclick="resetAdminTicketForm()">ุฅุนุงุฏุฉ ุชุนููู</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Ticket Details Section (for adding photos and quality review) -->
                <div id="admin-ticket-details-section" style="display: none; margin-top: 30px;">
                    <div class="card">
                        <div class="card-header">
                            <h2>ุชูุงุตูู ุงูุชูุช #<span id="admin-detail-ticket-number"></span></h2>
                        </div>
                        <div class="card-body">
                            <!-- Photos Section -->
                            <div style="margin-bottom: 30px;">
                                <h3>ุฑูุน ุงูุตูุฑ</h3>
                                <div class="form-group">
                                    <label>ููุน ุงูุตูุฑุฉ</label>
                                    <select id="admin_photo_type">
                                        <option value="pole_before">ูุงุช ุงูุนุงููุฏ ูุจู</option>
                                        <option value="pole_after">ูุงุช ุงูุนุงููุฏ ุจุนุฏ</option>
                                        <option value="pppoe">PPPoE</option>
                                        <option value="equipment_location">ููุงู ุงูุฃุฌูุฒุฉ</option>
                                        <option value="subscriber_power">ุจูุฑ ุงููุดุชุฑู</option>
                                        <option value="dhcp_status">ูุถุน DHCP</option>
                                        <option value="speed_test">ุณุจูุฏ ุชูุณุช</option>
                                        <option value="google_bank">ุจูู ุฌูุฌู</option>
                                        <option value="activation_message">ุฑุณุงูุฉ ุงูุชูุนูู</option>
                                        <option value="rx_power">RX Power</option>
                                    </select>
                                </div>
                                <div class="photo-upload-area" id="adminPhotoUploadArea">
                                    <p>ุงุณุญุจ ุงูุตูุฑ ููุง ุฃู ุงุถุบุท ููุงุฎุชูุงุฑ</p>
                                    <input type="file" id="adminPhotoInput" multiple accept="image/*" style="display: none;">
                                </div>
                                <div class="photo-grid" id="adminPhotoGrid"></div>
                            </div>

                            <!-- Quality Review Section -->
                            <div style="margin-bottom: 30px;">
                                <h3>ุชูููู ุงูุฌูุฏุฉ</h3>
                                <form id="adminQualityReviewForm">
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label for="admin_contact_status">ุญุงูุฉ ุงูุงุชุตุงู *</label>
                                            <select id="admin_contact_status" required>
                                                <option value="answered">ุชู ุงูุฑุฏ</option>
                                                <option value="no_answer">ูู ูุฑุฏ</option>
                                                <option value="closed">ูุบูู</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="admin_service_status">ุญุงูุฉ ุงูุฎุฏูุฉ *</label>
                                            <select id="admin_service_status" required>
                                                <option value="excellent">ููุชุงุฒ</option>
                                                <option value="good">ุฌูุฏ</option>
                                                <option value="poor">ุฑุฏูุก</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="admin_team_rating">ุชูููู ุฃุฏุงุก ุงููุฑูู (1-5) *</label>
                                            <input type="number" id="admin_team_rating" min="1" max="5" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="admin_subscription_amount">ูุจูุบ ุงูุงุดุชุฑุงู</label>
                                            <input type="number" id="admin_subscription_amount" step="0.01">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>ุงูุฎุฏูุงุช ุงููุดุฑูุญุฉ ูููุดุชุฑู:</label>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_explained_sinmana">
                                            <label for="admin_explained_sinmana">ุณูููุงูุง</label>
                                        </div>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_explained_platform">
                                            <label for="admin_explained_platform">ููุตุฉ</label>
                                        </div>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_explained_mytv_plus">
                                            <label for="admin_explained_mytv_plus">MyTV+</label>
                                        </div>
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_explained_shahid_plus">
                                            <label for="admin_explained_shahid_plus">ุดุงูุฏ ุจูุณ</label>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_whatsapp_group_interest">
                                            <label for="admin_whatsapp_group_interest">ูุฑุบุจ ุจุงูุงูุถูุงู ููุฑูุจ ุงููุงุชุณุงุจ</label>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="admin_needs_followup">
                                            <label for="admin_needs_followup">ูุญุชุงุฌ ูุชุงุจุนุฉ</label>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group" id="adminFollowupReasonGroup" style="display: none;">
                                        <label for="admin_followup_reason">ุณุจุจ ุงููุชุงุจุนุฉ</label>
                                        <select id="admin_followup_reason">
                                            <option value="amount_mismatch">ูุจูุบ ุบูุฑ ูุชุทุงุจู</option>
                                            <option value="technical_issue">ูุดููุฉ ูููุฉ</option>
                                            <option value="violation">ุชุฌุงูุฒ</option>
                                            <option value="complaint">ุดููู</option>
                                            <option value="poor_service">ุฎุฏูุฉ ุฑุฏูุฆุฉ</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="admin_review_notes">ููุงุญุธุงุช ุงูุฌูุฏุฉ</label>
                                        <textarea id="admin_review_notes" rows="3"></textarea>
                                    </div>
                                    
                                    <div class="btn-group">
                                        <button type="submit" class="btn btn-primary">ุญูุธ ุงูุชูููู</button>
                                        <button type="button" class="btn btn-success" onclick="generateAdminMessage()">ุชูููุฏ ุฑุณุงูุฉ</button>
                                    </div>
                                </form>
                            </div>

                            <!-- Generated Message -->
                            <div id="adminMessageSection" style="display: none;">
                                <h3>ุงูุฑุณุงูุฉ ุงูุฌุงูุฒุฉ</h3>
                                <div class="message-box">
                                    <textarea id="adminGeneratedMessage" readonly></textarea>
                                    <button class="btn btn-copy" onclick="copyAdminMessage()">ูุณุฎ ุงูุฑุณุงูุฉ</button>
                                </div>
                            </div>

                            <!-- Scores Display -->
                            <div id="adminScoresSection" style="margin-top: 30px;">
                                <h3>ุงูููุงุท</h3>
                                <div class="score-display" id="adminScoreDisplay"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/datetime-picker.js"></script>
    <script src="/js/time-picker.js"></script>
    <script src="/js/admin-dashboard.js"></script>
</body>
</html>

