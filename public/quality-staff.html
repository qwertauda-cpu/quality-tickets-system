<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>ูุงุฌูุฉ ููุธู ุงูุฌูุฏุฉ - ูุธุงู ุฅุฏุงุฑุฉ ุงูุชูุชุงุช</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">โฐ</button>
    <div class="mobile-menu-overlay" onclick="toggleMobileMenu()"></div>
    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>๐ ููุธู ุงูุฌูุฏุฉ</h2>
                <p id="userName"></p>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="active" data-page="new-ticket"><i>โ</i> ุฅุฏุฎุงู ุชูุช ุฌุฏูุฏ</a></li>
                <li><a href="#" data-page="tickets-list"><i>๐</i> ูุงุฆูุฉ ุงูุชูุชุงุช</a></li>
                <li><a href="#" data-page="followup"><i>๐</i> ุงููุชุงุจุนุฉ</a></li>
                <li><a href="#" data-page="daily-report"><i>๐</i> ุงูุชูุฑูุฑ ุงููููู</a></li>
                <li><a href="#" onclick="logout(); return false;"><i>๐ช</i> ุชุณุฌูู ุงูุฎุฑูุฌ</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="header">
                <h1 id="pageTitle">ุฅุฏุฎุงู ุชูุช ุฌุฏูุฏ</h1>
                <div class="user-info">
                    <span id="currentUser"></span>
                    <a href="#" class="btn-logout" onclick="logout(); return false;">ุชุณุฌูู ุงูุฎุฑูุฌ</a>
                </div>
            </div>

            <!-- New Ticket Form -->
            <div id="new-ticket-page" class="page-content">
                <div class="card">
                    <div class="card-header">
                        <h2>ุฅุฏุฎุงู ุชูุช ุฌุฏูุฏ</h2>
                    </div>
                    <div class="card-body">
                        <form id="ticketForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="ticket_number">ุฑูู ุงูุชูุช *</label>
                                    <input type="text" id="ticket_number" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="ticket_type_id">ููุน ุงูุชูุช *</label>
                                    <select id="ticket_type_id" required>
                                        <option value="">ุงุฎุชุฑ ุงูููุน</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="team_id">ุงููุฑูู *</label>
                                    <select id="team_id" required>
                                        <option value="">ุงุฎุชุฑ ุงููุฑูู</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>ุชุงุฑูุฎ ุงุณุชูุงู ุงูุชูุช (T0) *</label>
                                    <div id="time_received_container"></div>
                                    <div id="time_received_time_container" style="margin-top: 10px;"></div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ุชุงุฑูุฎ ุฃูู ุงุชุตุงู (T1)</label>
                                    <div id="time_first_contact_container"></div>
                                    <div id="time_first_contact_time_container" style="margin-top: 10px;"></div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ุชุงุฑูุฎ ุฑุณุงูุฉ ุงูุชูุนูู (T3)</label>
                                    <div id="time_completed_container"></div>
                                    <div id="time_completed_time_container" style="margin-top: 10px;"></div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="subscriber_name">ุงุณู ุงููุดุชุฑู</label>
                                    <input type="text" id="subscriber_name">
                                </div>
                                
                                <div class="form-group">
                                    <label for="subscriber_phone">ุฑูู ุงููุดุชุฑู</label>
                                    <input type="text" id="subscriber_phone">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="subscriber_address">ุนููุงู ุงููุดุชุฑู</label>
                                <textarea id="subscriber_address" rows="2"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="notes">ููุงุญุธุงุช</label>
                                <textarea id="notes" rows="3"></textarea>
                            </div>
                            
                            <div class="btn-group">
                                <button type="submit" class="btn btn-primary">ุญูุธ ุงูุชูุช</button>
                                <button type="button" class="btn btn-secondary" onclick="resetForm()">ุฅุนุงุฏุฉ ุชุนููู</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Ticket Details Page (for adding photos and quality review) -->
            <div id="ticket-details-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ุชูุงุตูู ุงูุชูุช #<span id="detail-ticket-number"></span></h2>
                        <button class="btn btn-secondary" onclick="showPage('new-ticket')">โ ุฑุฌูุน</button>
                    </div>
                    <div class="card-body">
                        <!-- Photos Section -->
                        <div style="margin-bottom: 30px;">
                            <h3>ุฑูุน ุงูุตูุฑ</h3>
                            <div class="form-group">
                                <label>ููุน ุงูุตูุฑุฉ</label>
                                <select id="photo_type">
                                    <option value="pole_before">ูุงุช ุงูุนุงููุฏ ูุจู</option>
                                    <option value="pole_after">ูุงุช ุงูุนุงููุฏ ุจุนุฏ</option>
                                    <option value="pppoe">PPPoE</option>
                                    <option value="equipment_location">ููุงู ุงูุฃุฌูุฒุฉ</option>
                                    <option value="subscriber_power">ุจูุฑ ุงููุดุชุฑู</option>
                                    <option value="dhcp_status">ูุถุน DHCP</option>
                                    <option value="speed_test">ุณุจูุฏ ุชูุณุช</option>
                                    <option value="google_bank">ุจูู ุฌูุฌู</option>
                                    <option value="activation_message">ุฑุณุงูุฉ ุงูุชูุนูู</option>
                                    <option value="rx_power">RX Power</option>
                                </select>
                            </div>
                            <div class="photo-upload-area" id="photoUploadArea">
                                <p>ุงุณุญุจ ุงูุตูุฑ ููุง ุฃู ุงุถุบุท ููุงุฎุชูุงุฑ</p>
                                <input type="file" id="photoInput" multiple accept="image/*" style="display: none;">
                            </div>
                            <div class="photo-grid" id="photoGrid"></div>
                        </div>

                        <!-- Quality Review Section -->
                        <div style="margin-bottom: 30px;">
                            <h3>ุชูููู ุงูุฌูุฏุฉ</h3>
                            <form id="qualityReviewForm">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="contact_status">ุญุงูุฉ ุงูุงุชุตุงู *</label>
                                        <select id="contact_status" required>
                                            <option value="answered">ุชู ุงูุฑุฏ</option>
                                            <option value="no_answer">ูู ูุฑุฏ</option>
                                            <option value="closed">ูุบูู</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="service_status">ุญุงูุฉ ุงูุฎุฏูุฉ *</label>
                                        <select id="service_status" required>
                                            <option value="excellent">ููุชุงุฒ</option>
                                            <option value="good">ุฌูุฏ</option>
                                            <option value="poor">ุฑุฏูุก</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="team_rating">ุชูููู ุฃุฏุงุก ุงููุฑูู (1-5) *</label>
                                        <input type="number" id="team_rating" min="1" max="5" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="subscription_amount">ูุจูุบ ุงูุงุดุชุฑุงู</label>
                                        <input type="number" id="subscription_amount" step="0.01">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ุงูุฎุฏูุงุช ุงููุดุฑูุญุฉ ูููุดุชุฑู:</label>
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="explained_sinmana">
                                        <label for="explained_sinmana">ุณูููุงูุง</label>
                                    </div>
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="explained_platform">
                                        <label for="explained_platform">ููุตุฉ</label>
                                    </div>
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="explained_mytv_plus">
                                        <label for="explained_mytv_plus">MyTV+</label>
                                    </div>
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="explained_shahid_plus">
                                        <label for="explained_shahid_plus">ุดุงูุฏ ุจูุณ</label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="whatsapp_group_interest">
                                        <label for="whatsapp_group_interest">ูุฑุบุจ ุจุงูุงูุถูุงู ููุฑูุจ ุงููุงุชุณุงุจ</label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="needs_followup">
                                        <label for="needs_followup">ูุญุชุงุฌ ูุชุงุจุนุฉ</label>
                                    </div>
                                </div>
                                
                                <div class="form-group" id="followupReasonGroup" style="display: none;">
                                    <label for="followup_reason">ุณุจุจ ุงููุชุงุจุนุฉ</label>
                                    <select id="followup_reason">
                                        <option value="amount_mismatch">ูุจูุบ ุบูุฑ ูุชุทุงุจู</option>
                                        <option value="technical_issue">ูุดููุฉ ูููุฉ</option>
                                        <option value="violation">ุชุฌุงูุฒ</option>
                                        <option value="complaint">ุดููู</option>
                                        <option value="poor_service">ุฎุฏูุฉ ุฑุฏูุฆุฉ</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="review_notes">ููุงุญุธุงุช ุงูุฌูุฏุฉ</label>
                                    <textarea id="review_notes" rows="3"></textarea>
                                </div>
                                
                                <div class="btn-group">
                                    <button type="submit" class="btn btn-primary">ุญูุธ ุงูุชูููู</button>
                                    <button type="button" class="btn btn-success" onclick="generateMessage()">ุชูููุฏ ุฑุณุงูุฉ</button>
                                </div>
                            </form>
                        </div>

                        <!-- Generated Message -->
                        <div id="messageSection" style="display: none;">
                            <h3>ุงูุฑุณุงูุฉ ุงูุฌุงูุฒุฉ</h3>
                            <div class="message-box">
                                <textarea id="generatedMessage" readonly></textarea>
                                <button class="btn btn-copy" onclick="copyMessage()">ูุณุฎ ุงูุฑุณุงูุฉ</button>
                            </div>
                        </div>

                        <!-- Scores Display -->
                        <div id="scoresSection" style="margin-top: 30px;">
                            <h3>ุงูููุงุท</h3>
                            <div class="score-display" id="scoreDisplay"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tickets List Page -->
            <div id="tickets-list-page" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h2>ูุงุฆูุฉ ุงูุชูุชุงุช</h2>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="ticketsTable">
                                <thead>
                                    <tr>
                                        <th>ุฑูู ุงูุชูุช</th>
                                        <th>ุงูููุน</th>
                                        <th>ุงููุฑูู</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุงูููุช ุงููุนูู</th>
                                        <th>ุงูููุงุท</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="ticketsTableBody">
                                    <tr>
                                        <td colspan="7" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/datetime-picker.js"></script>
    <script src="/js/time-picker.js"></script>
    <script src="/js/quality-staff.js"></script>
</body>
</html>

